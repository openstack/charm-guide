.. _release_notes_19.04

=============
19.04 (DRAFT)
=============

Summary
=======

The 19.04 OpenStack Charm release includes updates for the following charms.  Additional charm support status information is published in the main `charm guide <openstack-charms.html>`__ which ultimately supersedes release note contents.

Supported Charms
~~~~~~~~~~~~~~~~

* aodh
* barbican
* ceilometer
* ceilometer-agent
* ceph-fs
* ceph-mon
* ceph-osd
* ceph-proxy
* ceph-radosgw
* cinder
* cinder-backup
* cinder-ceph
* designate
* designate-bind
* glance
* gnocchi
* hacluster
* heat
* keystone
* keystone-ldap
* lxd
* manila
* manila-generic
* neutron-api
* neutron-openvswitch
* neutron-gateway
* neutron-dynamic-routing
* nova-cloud-controller
* nova-compute
* openstack-dashboard
* percona-cluster
* rabbitmq-server
* swift-proxy
* swift-storage
* vault

Pre-Release Charms
~~~~~~~~~~~~~~~~~~
* octavia
* barbican-vault

Removed Charms
~~~~~~~~~~~~~~

The following charms have been removed as part of this charm release:

 * glusterfs (unmaintained)
 * interface-odl-controller-api (unmaintained)
 * manila-glusterfs (unmaintained)
 * murano (unmaintained)
 * neutron-api-odl (unmaintained)
 * nova-compute-proxy (unmaintained)
 * odl-controller (unmaintained)
 * openvswitch-odl (unmaintained)
 * trove (unmaintained)

New Charm Features
==================

pci passthrough for gpu and other devices
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The requirements and configuration for passing arbitrary PCI devices through
to Nova KVM instances are now detailed in the charm deployment guide.

A common use case for this configuration is to provide direct access to a
GPGPU device within a virtual machine.

Please refer to the `charm deployment guide <https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/app-pci-passthrough-gpu.html>`_ for more details.

ceph-radosgw: multisite replication
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The ceph-radosgw charm now features support for replication between RADOS Gateway
deployments; please refer to `Appendix J <https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/app-rgw-multisite.html>`_
of the charm deployment guide for more details.


rabbitmq integration refactor
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Rabbitmq sectional configuration was deprecated and removed, replaced by
transport_url configuration in the [DEFAULT] section.  As part of this
change, a wider refactoring of the rabbitmq-server integration was done.

The ceilometer-agent charm now requires a direct amqp relation to the
rabbitmq-server charm.

Users upgrading the ceilometer-agent charm to the 19.04 charm revision
will need to add a relation, as ceilometer-agent units will go into a
BLOCKED state for lack of this new required relation.  Users and operators
will also need to update any relevant bundles accordingly.

For example:

.. code:: bash

    juju add-relation ceilometer-agent:amqp rabbitmq-server:amqp

Reference:
 - https://launchpad.net/bugs/1817672
 - https://review.openstack.org/#/c/639333
 - https://review.openstack.org/#/q/topic:bug/1817672+(status:open+OR+status:merged)

neutron-api: FWaaS v2
~~~~~~~~~~~~~~~~~~~~~

For the OpenStack Stein release FWaaS v1 has been dropped; FWaaS v2
will be automatically enabled and existing FWaaS v1 definitions migrated
to v2 on upgrade.


Upgrading charms
================

Please ensure that the keystone charm is upgraded first.

To upgrade an existing deployment to the latest charm version simply use the
'upgrade-charm' command, for example:

.. code:: bash

    juju upgrade-charm keystone

Charm upgrades and OpenStack upgrades are two distinctly different things. Charm upgrades ensure that the deployment is using the latest charm revision, containing the latest charm fixes and charm features available for a given deployment.

Charm upgrades do not cause OpenStack versions to upgrade, however OpenStack upgrades do require the latest Charm version as pre-requisite.

Upgrading OpenStack
===================

To upgrade an existing Queens based deployment on Ubuntu 18.04 to the Rocky
release, re-configure the charm with a new openstack-origin
configuration:

.. code:: bash

    juju config nova-cloud-controller openstack-origin=cloud:bionic-rocky

Please ensure that ceph services are upgraded before services that consume ceph
resources, such as cinder, glance and nova-compute:

.. code:: bash

    juju config ceph-mon source=cloud:bionic-rocky
    juju config ceph-osd source=cloud:bionic-rocky

.. note::

   Upgrading an OpenStack cloud is still not without risk; upgrades should
   be tested in pre-production testing environments prior to production deployment
   upgrades.

See https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/app-upgrade-openstack.html for more details.

New Bundle Features
===================

Deprecation Notices
===================

Removed Features
================

nova-cloud-controller: single-nova-consoleauth
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The 'single-nova-consoleauth' feature has been removed from the nova-cloud-controller charm; this legacy feature has been superceeded by the use of nova-consoleauth daemons on all nova-cloud-controller units, sharing authentication tokens using memcached.

Cluster resources associated with this feature will be cleaned up up during charm upgrade.

If the charm is running in an HA deployment, a relation to memcached must be added to the nova-cloud-controller application:

.. code:: bash

    juju add-relation nova-cloud-controller memcached

Known Issues
============

Bugs Fixed
==========

This release includes 47 bug fixes. For the full list of bugs resolved for the 19.04 charms release please refer to https://launchpad.net/openstack-charms/+milestone/19.04.

Next Release Info
=================
Please see https://docs.openstack.org/charm-guide/latest for current information.

