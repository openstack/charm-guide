.. _release_notes_19.10:

=============
19.10 (DRAFT)
=============

Summary
=======

The 19.10 OpenStack Charm release includes updates for the following charms.
Additional charm support status information is published in the main
`charm guide <openstack-charms.html>`__ which ultimately supersedes release
note contents.

Always use the latest stable charm revision before proceeding with topological
changes, application migrations, workload upgrades, series upgrades, or bug
reports.

Supported Charms
~~~~~~~~~~~~~~~~

* aodh
* barbican
* barbican-vault
* ceilometer
* ceilometer-agent
* ceph-mon
* ceph-osd
* ceph-proxy
* ceph-radosgw
* ceph-rbd-mirror
* cinder
* cinder-ceph
* designate
* designate-bind
* glance
* gnocchi
* hacluster
* heat
* keystone
* keystone-ldap
* lxd
* neutron-api
* neutron-openvswitch
* neutron-gateway
* neutron-dynamic-routing
* nova-cloud-controller
* nova-compute
* octavia
* openstack-dashboard
* percona-cluster
* rabbitmq-server
* swift-proxy
* swift-storage
* vault

Preview Charms
~~~~~~~~~~~~~~

* barbican-softhsm
* ceph-fs
* cinder-backup
* keystone-saml-mellon
* manila
* manila-generic
* masakari
* masakari-monitors
* pacemaker-remote
* tempest

Removed Charms
~~~~~~~~~~~~~~

The following charms have been removed as part of this charm release:

New Charm Features
==================

With each new feature, there is a corresponding example bundle in the form of
a test bundle, and/or a `charm deployment guide <https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/>`__
section which details the use of the feature.  For example test bundles, see the
src/tests/bundles/ directory within the relevant charm repository.

nova-cloud-controller: instance migration - DNS caching is now the default
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note:: This has nothing to do with Designate or Neutron DNS

The 19.07 release introduced the option to enable caching of DNS lookups
of the nova-compute units which are used by nova to perform migrations of
tenant instances between nova-compute units.  This was not enabled by
default.  The 19.10 release "flips the swtich" and enables this option by
default so that after upgrade, if the option was not explicitly set, DNS
results will be cached automatically.  New clouds will also, unless the
option is explicitly set to false, cache DNS host lookups.

The reason for caching DNS host lookups is to reduce the time to add
nova-compute units to an existing cloud, or during first deployment.

Please see the config option ``cache-known-hosts`` on the
nova-cloud-controller charm for further details.

OpenStack Train
~~~~~~~~~~~~~~~

The 19.10 OpenStack Charms release introduces support for OpenStack Train on
Ubuntu 18.04 (LTS) and Ubuntu 19.10.

Additional charm support status information is published in the main
`charm guide <openstack-charms.html>`__ which ultimately supersedes release
note contents.

Policy Overrides
~~~~~~~~~~~~~~~~

The Policy Overrides feature provides operators with a mechanism to override
policy defaults on a per-service basis.

Policy defaults for an OpenStack service are defined via "policy-in-code"
and/or via a default policy YAML file provided by the charm. The operator can
use the new feature by providing a ZIP file consisting of at least one YAML
file which contains policy rules that the service will observe when responding
to API queries.  This allows operators to selectively override the default
policies of that service.

This feature is being provided in the following charms:

- cinder
- designate
- glance
- keystone
- neutron-api
- nova-cloud-controller

For further details consult `Appendix N: Policy Overrides
<https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/app-policy-overrides.html>`_
of the Charm Deployment Guide.

Please consult the README for each charm to determine exactly what is provided
with respect to this feature.

Ceph Nautilus
-------------

Along with OpenStack Train, the 19.10 charm release includes support for
the Nautilus release of Ceph.

Ceph Placement Group Autotuning
-------------------------------

In Ceph Nautilus, the OpenStack Charms now support autotuning of placement groups.
The new pg_autoscaler module allows the cluster to consider the amount of data
stored, or expected, in each pool and manage the correct pg_num values automatically.

This feature can be disabled entirely by setting a new configuration option,
pg-autotune, to "false". This option defaults to "auto" which will cause new
deployments on Ceph Nautilus to enable the autoscaler, but older releases
upgraded to Nautilus will need to explicitly opt-in by setting pg-autotune
to "true".

Neutron Port Forwarding
~~~~~~~~~~~~~~~~~~~~~~~

Neutron Port forwarding extension can now be optionally enabled with 19.10
charms for OpenStack Rocky and later. Be aware that the Train openstack-client
version (or later) may be required in order to interact with the feature from the
command line.

For more information on this feature see the `Neutron documentation <https://docs.openstack.org/neutron/latest/admin/config-fip-port-forwardings.html>`__.

Migration to FQDN for agent registration
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting with the 19.10 charms when deploying OpenStack Stein or newer, the
Nova Compute agent as deployed by the ``nova-compute`` charm and Neutron
agents as deployed by the ``neutron-openvswitch`` charm will use a fully
qualified domain name (FQDN) when registering with the API services.

As the name an agent registers with is referenced across multiple services in a
OpenStack cloud this change will only apply to newly deployed units.  Upgrading
the above two charms or upgrading OpenStack will not trigger the new behaviour.

The backdrop of the change is:

- Fix bugs in third party services relating to consistency of hypervisor naming
  in Nova.

- Avoid deploy time issues in the event a node is configured without a search
  domain, and also support clouds with a segregated DNS layout.

- Switch to a more sensible default mode of operation enabling easier
  integration with new technologies such as OVN.


Preview Charm Features
======================

Feature 1
~~~~~~~~~

Feature details tbd.

Please refer to
`Appendix L <https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/>`_
of the charm deployment guide for more details.

Upgrading charms
================

Always use the latest stable charm revision before proceeding with topological
changes, charm application migrations, workload upgrades, series upgrades, or
bug reports.

Please ensure that the keystone charm is upgraded first.

To upgrade an existing deployment to the latest charm version simply use the
'upgrade-charm' command, for example:

.. code:: bash

    juju upgrade-charm keystone

Charm upgrades and OpenStack upgrades are two distinctly different things.
Charm upgrades ensure that the deployment is using the latest charm
revision, containing the latest charm fixes and charm features available
for a given deployment.

Charm upgrades do not cause OpenStack versions to upgrade, however OpenStack
upgrades do require the latest Charm version as pre-requisite.

Upgrading OpenStack
===================

Before upgrading OpenStack, all OpenStack Charms should be running the latest
stable charm revision.

To upgrade an existing Steins based deployment on Ubuntu 18.04 to the Train
release, re-configure the charm with a new openstack-origin
configuration:

.. code:: bash

    juju config nova-cloud-controller openstack-origin=cloud:bionic-train

Please ensure that ceph services are upgraded before services that consume ceph
resources, such as cinder, glance and nova-compute:

.. code:: bash

    juju config ceph-mon source=cloud:bionic-train
    juju config ceph-osd source=cloud:bionic-train

.. note::

   Upgrading an OpenStack cloud is not without risk; upgrades should be tested
   in pre-production testing environments prior to production deployment
   upgrades.

See https://docs.openstack.org/project-deploy-guide/charm-deployment-guide/latest/app-upgrade-openstack.html
for more details.

New Bundle Features
===================

Deprecation Notices
===================

Removed Features
================

Ceph Nautilus has removed support for directory backed OSDs. The
charms will allow for the creation of directory backed OSDs on
older Ceph releases but will log a warning about their use from
Nautilus onwards. Existing directory backed OSDs will continue to
function after an upgrade to Nautilus.

Known Issues
============

Masakari and Masakari Monitors
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Both Masakari charms remain as previews. Bugs `1728527 <https://bugs.launchpad.net/masakari-monitors/+bug/1728527>`__
and `1839715 <https://bugs.launchpad.net/masakari/+bug/1839715>`__ are both
in progress and need to land for a successful Instance HA deployment. Bug `1773765 <https://bugs.launchpad.net/masakari/+bug/1773765>`__
is still open and is likely to affect on-going support of a Masakari
deployment.

Bugs Fixed
==========

This release includes NNN bug fixes. For the full list of bugs resolved for the
19.10 charms release please refer to https://launchpad.net/openstack-charms/+milestone/19.04.

Next Release Info
=================
Please see https://docs.openstack.org/charm-guide/latest for current information.
